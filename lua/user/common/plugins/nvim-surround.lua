--[[
=====================================================================
                        NVIM-SURROUND
=====================================================================
Плагин для работы с окружающими символами (скобки, кавычки, теги).

Как использовать:
  ys{motion}{char}  - добавить окружение (например: ysiw" - окружить слово кавычками)
  ds{char}          - удалить окружение (например: ds" - удалить кавычки)
  cs{old}{new}      - изменить окружение (например: cs"' - заменить " на ')
  
Примеры:
  ysiw)    - окружить слово круглыми скобками: word -> (word)
  yss"     - окружить всю строку кавычками
  ds]      - удалить квадратные скобки: [word] -> word
  cs'"     - заменить одинарные кавычки на двойные: 'word' -> "word"
  ysiw<div> - окружить HTML тегом: word -> <div>word</div>
  dst      - удалить HTML тег: <div>word</div> -> word
  
В визуальном режиме:
  S{char}  - окружить выделенный текст
  
GitHub: https://github.com/kylechui/nvim-surround
=====================================================================
--]]

return {
  "kylechui/nvim-surround",
  version = "*", -- Использовать стабильную версию
  event = "VeryLazy", -- Ленивая загрузка
  
  opts = {
    -- Сочетания клавиш (можно переопределить)
    keymaps = {
      insert = "<C-g>s",          -- Добавить окружение в insert mode
      insert_line = "<C-g>S",     -- Добавить окружение на новых строках
      normal = "ys",              -- Добавить окружение
      normal_cur = "yss",         -- Добавить окружение на всю строку
      normal_line = "yS",         -- Добавить окружение на новых строках
      normal_cur_line = "ySS",    -- Добавить окружение на строку (новые строки)
      visual = "S",               -- Окружить в visual mode
      visual_line = "gS",         -- Окружить с новыми строками
      delete = "ds",              -- Удалить окружение
      change = "cs",              -- Изменить окружение
      change_line = "cS",         -- Изменить окружение (новые строки)
    },
    
    -- Окружения для разных символов
    surrounds = {
      -- Скобки с пробелами внутри
      ["("] = { add = { "( ", " )" } },
      [")"] = { add = { "(", ")" } },
      ["{"] = { add = { "{ ", " }" } },
      ["}"] = { add = { "{", "}" } },
      ["<"] = { add = { "< ", " >" } },
      [">"] = { add = { "<", ">" } },
      ["["] = { add = { "[ ", " ]" } },
      ["]"] = { add = { "[", "]" } },
      
      -- Кавычки
      ["'"] = { add = { "'", "'" } },
      ['"'] = { add = { '"', '"' } },
      ["`"] = { add = { "`", "`" } },
    },
    
    -- Псевдонимы для часто используемых окружений
    aliases = {
      ["a"] = ">",                -- angle brackets
      ["b"] = ")",                -- brackets (круглые)
      ["B"] = "}",                -- Braces (фигурные)
      ["r"] = "]",                -- бРаккетс (квадратные)
      ["q"] = { '"', "'", "`" },  -- quotes (кавычки)
      ["s"] = { "}", "]", ")", ">", '"', "'", "`" }, -- все окружения
    },
    
    -- Подсветка при операциях
    highlight = {
      duration = 200, -- Длительность подсветки в мс
    },
    
    -- Перемещать курсор на окружение после добавления
    move_cursor = "begin",
    
    -- Отступы при добавлении окружения на новых строках
    indent_lines = function(start, stop)
      local b = vim.bo
      -- Не делать отступы для определённых типов файлов
      if b.filetype == "python" then
        return
      end
      vim.cmd(string.format("silent normal! %dG=%dG", start, stop))
    end,
  },
  
  config = function(_, opts)
    require("nvim-surround").setup(opts)
  end,
}
